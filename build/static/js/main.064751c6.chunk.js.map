{"version":3,"sources":["components/upload.module.css","components/UploadVideo.js","utils/hostname.js","pages/Index.js","App.js","index.js"],"names":["module","exports","UploadVideo","props","useState","title","setTitle","content","setContent","warn","setWarn","upload","useRef","handleClose","className","styles","dialog_wrapper","onClick","dialog","e","stopPropagation","htmlFor","type","value","onChange","target","name","id","cols","rows","console","log","files","ref","accept","submit","current","file","size","toFixed","url","param","FormData","append","axios","post","headers","onUploadProgress","progressEvent","complete","loaded","total","then","response","img","data","code","message","img_url","handleImgUrl","Index","isVisibleUpload","setIsVisibleUpload","imgList","setImgList","stylesLi","listStyle","marginTop","borderBottom","length","map","item","index","style","key","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.064751c6.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog_wrapper\":\"upload_dialog_wrapper__3IyZ1\",\"dialog\":\"upload_dialog__epJoY\",\"warn\":\"upload_warn__eAiC5\",\"submit\":\"upload_submit__526SI\"};","import React, {useState, useRef} from 'react'\r\nimport  styles from  './upload.module.css';\r\nimport hostname from '../utils/hostname';\r\nimport axios from 'axios';\r\n\r\nconst UploadVideo = (props) => {\r\n    const [title, setTitle] = useState('')\r\n    const [content, setContent] = useState('')\r\n    const [warn, setWarn] = useState('')\r\n    const upload = useRef()\r\n\r\n    function handleChangeTitle(e) {\r\n        setTitle(e.target.value)\r\n    }\r\n\r\n    function handleChangeContent(e) {\r\n        setContent(e.target.value)\r\n    }\r\n\r\n    function handleClose() {\r\n        props.handleClose()\r\n    }\r\n\r\n    function handleStopPropagation(e) {\r\n        e.stopPropagation()\r\n    }\r\n\r\n    function handleUploadFile(e) {\r\n        console.log(e.target.files)\r\n    }\r\n\r\n    // 提交\r\n    function handleSubmit() {\r\n        if(!title) {\r\n            setWarn('标题未输入')\r\n            return\r\n        }\r\n        if(!content) {\r\n            setWarn('内容未输入')\r\n            return\r\n        }\r\n        if(!upload.current.files[0]) {\r\n            setWarn('未检测到上传文件')\r\n            return\r\n        }else {\r\n            let file = upload.current.files[0]\r\n            if(file.type !== 'video/mp4') {\r\n                setWarn('请上传mp4格式的视频')\r\n                return\r\n            }\r\n            if((file.size/1024/1024).toFixed(2) > 50) {\r\n                setWarn('请上传小于50Mb的文件')\r\n                return\r\n            }\r\n\r\n            // 上传视频文件\r\n            let url = `${hostname}/upload/video`\r\n            let param = new FormData()\r\n            param.append('file', file)\r\n            param.append('title', title)\r\n            param.append('content', content)\r\n\r\n            axios.post(url, param, {\r\n                headers: {\r\n                  'Content-Type': 'multipart/form-data'\r\n                },\r\n                onUploadProgress: progressEvent => {\r\n                    let complete = (progressEvent.loaded / progressEvent.total * 100 | 0) + '%'\r\n                    console.log(complete)\r\n                }\r\n            }).then((response) => {\r\n                if(response.data.code === 0) {\r\n                    console.log(response.data.message)\r\n                    handleImgUrl(response.data.img_url)\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    // 值传递给父组件\r\n    function handleImgUrl(img) {\r\n        handleClose()\r\n        props.handleImgUrl(img)\r\n    }\r\n\r\n    return (\r\n        <div className={styles.dialog_wrapper} onClick={handleClose}>\r\n            <div className={styles.dialog} onClick={handleStopPropagation}>\r\n                <label htmlFor=\"标题\">\r\n                    <span>标题</span>\r\n                    <input type=\"text\" value={title} onChange={handleChangeTitle} />\r\n                </label>\r\n                <label htmlFor=\"描述\">\r\n                    <span>描述</span>\r\n                    <textarea name=\"\" id=\"\" cols=\"30\" rows=\"10\" value={content} onChange={handleChangeContent}></textarea>\r\n                </label>\r\n                <label htmlFor=\"上传视频\">\r\n                    <span>上传视频</span>\r\n                    <input type=\"file\" onChange={handleUploadFile} ref={upload} name=\"file\" accept=\"video/mp4\"/>\r\n                </label>\r\n                {warn ? <p className={styles.warn}>{warn}</p> : null}\r\n                <button className={styles.submit} onClick={handleSubmit}>提交</button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default UploadVideo","const hostname = 'http://localhost:3000'\r\n\r\nexport default hostname","import React, { useState } from 'react';\r\nimport UploadVideo from '../components/UploadVideo';\r\n\r\nconst Index = () => {\r\n    const [isVisibleUpload, setIsVisibleUpload] = useState(false)\r\n    const [imgList, setImgList] = useState([])\r\n\r\n    function handleClick() {\r\n        setIsVisibleUpload(true)\r\n    }\r\n\r\n    function handleClose() {\r\n        setIsVisibleUpload(false)\r\n    }\r\n\r\n    function handleImgUrl(url) {\r\n        console.log(`fu ${url}`)\r\n        setImgList(imgList => [...imgList, url])\r\n        console.log(imgList)\r\n    }\r\n\r\n    const stylesLi = {\r\n        listStyle: 'none',\r\n        marginTop: 10 + 'px',\r\n        borderBottom: 1 + 'px',\r\n    }\r\n    return (\r\n        <div>\r\n            <p>请上传视频文件(仅支持mp4格式, 文件大小在50Mb以下)</p>\r\n            <button onClick={handleClick}>上传视频</button>\r\n            {isVisibleUpload ? <UploadVideo handleClose={handleClose} handleImgUrl={handleImgUrl}/> : null}\r\n            {imgList.length > 0 ? \r\n                <div>\r\n                    {imgList.map((item, index) => \r\n                        <li style={stylesLi} key={index}>{index+1}、 {item}</li>\r\n                    )}\r\n                </div>\r\n            : null}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Index","import React from 'react';\nimport './App.css'\nimport Index from './pages/Index';\n\nfunction App() {\n    return (\n        <div className=\"App\">\n            <Index />\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}